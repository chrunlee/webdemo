/*
	@company 博育云
	@site : www.boyuyun.cn
	@author boyuyun
*/

var searchselect=function(a){return new searchselect.fn.init(a)};searchselect.fn=searchselect.prototype={init:function(a){return this.opts=a,this.callback(),this}};var cls=["selected","item-list","item-add","loading-msg","search-list-wrap","item","close","byy-form-search-btn"];searchselect.fn.init.prototype=searchselect.fn,searchselect.fn.checkOpts=function(){var a=this,b=a.opts;return b.selector?(b.$ele=$(b.selector),!0):(byy.error("searchselect must has selector!"),!1)},searchselect.fn.callback=function(){var a=this,b=a.opts,c=b.selector,d=$(c),e=b.onAdd||"",f=b.onSelect||"",g=b.multi||!1,h=b.onKeyUp||"",i=b.onSearch||"";d.on("click","."+cls[2],function(a){var b=$(this),c=b.parent(),d=function(){c.find("."+cls[1]).toggleClass("hide"),c.find("."+cls[2]).toggleClass("hide"),setTimeout(function(){c.find("."+cls[3]).hide(),c.find("."+cls[4]).show()},50)};"function"==typeof e?e(d):setTimeout(d()),byy.stope(a)}),d.find("."+cls[4]).on("click","."+cls[5],function(a){var b=$(this);if("function"==typeof f){f(b,function(a){d.find("."+cls[0]).append(a),d.find("."+cls[1]).toggleClass("hide"),g?d.find("."+cls[2]).toggleClass("hide"):d.find("."+cls[2]).removeClass("hide").addClass("hide"),d.find("."+cls[3]).show(),d.find("."+cls[4]).hide()})}byy.stope(a)}),d.find("."+cls[0]).on("click","."+cls[6],function(a){var b=$(this),c=b.parent();"function"==typeof onRemove?onRemove(c):c.remove(),g||d.find("."+cls[2]).removeClass("hide"),byy.stope(a)});var j=function(a){var b=a.target||a.srcElement,c=$(b),e=c.parents("."+cls[1]).length>0,f=c.hasClass(cls[2])||c.parents("."+cls[2]).length>0,h=c.parents("."+cls[0]).length>0;e||f||h||(d.find("."+cls[1]).removeClass("hide").addClass("hide"),g?d.find("."+cls[2]).removeClass("hide"):d.find("."+cls[0]).find("."+cls[5]).length>0?d.find("."+cls[2]).removeClass("hide").addClass("hide"):d.find("."+cls[2]).removeClass("hide"),$("."+cls[3]).show(),$("."+cls[4]).hide()),byy.stope(a)};$("body").off("click",j).on("click",function(a){j(a)}),d.on("keyup","input",function(){var a=$(this),b=a.val();if(a.parent().find(".empty").remove(),"function"==typeof h)h(a,b);else{var c=a.parent().find("."+cls[4]),d=c.find("p"),e=0;d.each(function(){var a=$(this);a.find(".name").html().indexOf(b)>-1||""==byy.trim(b)?(a.show(),e++):a.hide()}),0==e&&c.append('<div class="empty" style="padding-left:10px;font-size:12px;color:#999;">没有检索到记录</div>')}}),d.on("click","."+cls[7],function(){"function"==typeof i&&i(d)})},byy.define(function(a){a("searchselect",searchselect)});